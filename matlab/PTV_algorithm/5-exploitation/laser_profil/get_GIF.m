% This function creates a GIF from data profil. The GIF is in data\GIF
%
% INPUTs:
% set: a set of images
% data_profil: output of the function build_profil 
% data_mask: data used to create a rectangulat mask
% my_name: the name of the GIF you want to create
% step: the step between 2 successives frames of the GIF

% OUTPUT:
% A GIF in data\GIF

function get_GIF(set, data_profil, data_mask ,my_name, step)

h = figure;
filename = strcat('data\GIF\',my_name,'.gif');

for i = 1:step:set.Count

    name = ['pict_', num2str(i)];
    array = data_profil.(name);
    x = array(:,1);
    y = array(:,2);
    plot(x,y);
    axis([data_mask(1,1) data_mask(1,1)+data_mask(1,3) data_mask(1,2) data_mask(1,2)+data_mask(1,4)]);
    axis ij manual equal 
    title({'Radial profile by laser' ['frame ' num2str(i)]});
    frame = getframe(h); 
    im = frame2im(frame); 
    [imind,cm] = rgb2ind(im,256); 
    
    % Write to the GIF File 
    if i == 1 
        imwrite(imind,cm,filename,'gif', 'Loopcount',inf); 
    else 
        imwrite(imind,cm,filename,'gif','WriteMode','append'); 
    end
    
end
close(h);

end