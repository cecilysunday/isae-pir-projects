% This function computes a new set of trajectories containing only the 
% trajectories with more than percent*nbImages/100 images.
%
% INPUTs:
% tr = a set of trajectories
% data_tracking = the output of get_data_tracking(set, tr)
% percent = the threshold required
%
%OUTPUT
% a new set of trajectories containing only the trajectories with a lenght
% superior to percent*nbImages/100 images

function result = compute_new_tr(tr, data_tracking, percent)

limit = floor(percent*data_tracking.nbImages/100);
index_new = 1;
result = [];
for index = 1:data_tracking.nbImages+1-limit
    for i=1:data_tracking.dataTrajectories(index,2)
        traj_ID = data_tracking.dataTrajectories(index,2+i);
        j=1;
        while tr(j,4) ~= traj_ID
            j=j+1;
        end
        result(index_new:index_new+data_tracking.dataTrajectories(index,1)-1,:) = tr(j:j+data_tracking.dataTrajectories(index,1)-1,:);
        index_new = index_new+data_tracking.dataTrajectories(index,1); 
    end
end
