function display_velocity_in_time(tr3,PIXEL_SCALE,nb_pictures,R_LAYER_WIDE)
tr_time = sortrows(tr3,3);
s = size(tr_time);
start = 0;
leg = {};%for the legend of the graph
s_leg = 1;
for i=1:s(1)
    %when a difference of nb_pictures is reached, compute mean velocity on
    %those pictures and plot it
    if (tr_time(i,3)-tr_time(start+1,3) == nb_pictures)
        tr_time_temp = sortrows(tr_time(start+1:i,:));
        V_temp = mean_velocity(R_LAYER_WIDE,tr_time_temp);
        start = i;
        
        %used for legend
        first_frame = num2str(nb_pictures*(s_leg-1)+1);
        last_frame = num2str(nb_pictures*s_leg);
        leg{s_leg} = strcat(first_frame,'-',last_frame);
        s_leg = s_leg + 1;
        
        %plot V_r and Vtheta
        subplot(1,2,1);
        plot(V_temp(:,3)/PIXEL_SCALE,V_temp(:,1)/PIXEL_SCALE);
        hold on;
        legend(leg);
        title("V_r profile at different times");

        subplot(1,2,2);
        plot(V_temp(:,3)/PIXEL_SCALE,V_temp(:,2)/PIXEL_SCALE);
        hold on;
        legend(leg);
        title("V_{theta} profile at different times");
    end
    %plot mean velocity for the remaining frames even if there are less
    %than nb_pictures frames left
    if (i==s(1))
        tr_time_temp = sortrows(tr_time(start+1:i,:));
        V_temp = mean_velocity(R_LAYER_WIDE,tr_time_temp);
        start = i;

        first_frame = num2str(nb_pictures*(s_leg-1)+1);
        last_frame = num2str(tr_time(i,3) + 1);
        leg{s_leg} = strcat(first_frame,'-',last_frame);
        s_leg = s_leg + 1;

        subplot(1,2,1);
        plot(V_temp(:,3)/PIXEL_SCALE,V_temp(:,1)/PIXEL_SCALE);
        hold on;
        legend(leg);
        title("V_r profile at different times");

        subplot(1,2,2);
        plot(V_temp(:,3)/PIXEL_SCALE,V_temp(:,2)/PIXEL_SCALE);
        hold on;
        legend(leg);
        title("V_{theta} profile at different times");
    end
end
end