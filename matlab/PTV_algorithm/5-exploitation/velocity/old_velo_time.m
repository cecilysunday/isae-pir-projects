 tr_time = sortrows(tr3,3);
    s = size(tr_time);
    start = 0;
    V_mean = [];
    s_V = 0;
    for i=1:s(1)
        if (tr_time(i,3)-tr_time(start+1,3) == nb_pictures)
            tr_time_temp = sortrows(tr_time(start+1:i,:));
            V_temp = mean_velocity(R_LAYER_WIDE,tr_time_temp);
            s_temp = size(V_temp);
            V_mean(1:s_temp(1),s_V+1:s_V+3) = V_temp;
            start = i;
            s_V = s_V + 3;
        end
%         if (i==s(1))
%             V_temp = mean_velocity(R_LAYER_WIDE,tr_time(start+1:i,:));
%             s_temp = size(V_temp);
%             V_mean(1:s_temp(1),s_V+1:s_V+3) = V_temp;
%             s_V = s_V + 3;
%         end
    end
    
    %Vr profile
    subplot(1,2,1);
    leg_vr = {};
    s_leg_vr = 1;
    for i=1:3:s_V
        hold on
        plot(V_mean(:,i+2)/PIXEL_SCALE,V_mean(:,i)/PIXEL_SCALE);
        first_frame = num2str(nb_pictures*(s_leg_vr-1)+1);
        last_frame = num2str(nb_pictures*s_leg_vr);
        leg_vr{s_leg_vr} = strcat(first_frame,'-',last_frame);
        s_leg_vr = s_leg_vr + 1;
    end
    legend(leg_vr);
    title("V_r profile at different times");
    
    %Vthetaprofile
    subplot(1,2,2);
    leg_vt = {};
    s_leg_vt = 1;
    for i=1:3:s_V
        hold on
        plot(V_mean(:,i+2)/PIXEL_SCALE,V_mean(:,i+1)/PIXEL_SCALE);
        first_frame = num2str(nb_pictures*(s_leg_vt-1)+1);
        last_frame = num2str(nb_pictures*s_leg_vt);
        leg_vt{s_leg_vt} = strcat(first_frame,'-',last_frame);
        s_leg_vt = s_leg_vt + 1;
    end
    legend(leg_vt);
    title("V_{theta} profile at different times");